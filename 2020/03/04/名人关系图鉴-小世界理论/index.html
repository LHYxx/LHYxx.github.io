<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content>
    <link rel="shortcut icon" href="/img/book.png">
    <title>名人关系图鉴-小世界理论-小新xx</title>
    
        
            <link href="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
            <link href="https://cdn.bootcss.com/academicons/1.8.6/css/academicons.min.css" rel="stylesheet">
            <link href="https://cdn.bootcss.com/font-awesome/5.9.0/css/all.min.css" rel="stylesheet">
            <link href="https://cdn.bootcss.com/animate.css/3.7.2/animate.min.css" rel="stylesheet">
        
    
    <link rel="stylesheet" href="/css/adagio.css">

    <style type="text/css">
        .jumbotron{
            background: url();
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }
        .tag-list{
            font-weight: bold;
            font-size: 200;
            color: red;
        }
    </style>

<!-- 下面是对mathjax的设置 -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true,
      linebreaks: {automatic: ['\\']}
    },
    "HTML-CSS": { linebreaks: { automatic: true } },
         SVG: { linebreaks: { automatic: true } }
  });
</script>



</head>
<body>
    <div class="container-fluid">
    <nav class="nav">
        <div class="collapse navbar-collapse" id="navbar-sm">
            
            
            <div class="navbar-nav">
                <a href="/index.html" class="nav-item nav-link">主页</a>
            </div>
            
            <div class="navbar-nav">
                <a href="/others/aboutme.html" class="nav-item nav-link">LHYxx</a>
            </div>
            
        </div>
    </nav>
</div>

<div class="d-flex d-md-none" style="width: 100%; background-color: #e9ecef">
    <div class="nav">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-sm"
            aria-expanded="false" aria-label="Toggle Navigation">
            <i class="fas fa-bars fa-lg"></i>
        </button>
    </div>
    <nav class="navbar ml-auto">
        <a class="navbar-brand" href="/">
            
            LHYxx
            
        </a>
    </nav>
</div>


<div class="container d-none d-md-block my-navbar">
    <nav class="navbar navbar-expand-sm navbar-light bg-transparent">
        <a class="navbar-brand " href="/">
            
            LHYxx
            
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                
                <li class="nav-item pl-2 pr-2 ">
                    <a class="nav-link" href="/index.html">主页</a>
                </li>
                
                <li class="nav-item pl-2 pr-2 ">
                    <a class="nav-link" href="/others/aboutme.html">LHYxx</a>
                </li>
                
            </ul>
        </div>
    </nav>
</div>




    <div class="jumbotron jumbotron-fluid">
<!-- <div class="jumbotron jumbotron-fluid" style="background-image: url()"> -->
    <div class="container" >
        
        <h1 class="mt-4 article-title page-title" style="font-weight: bold; color: black">名人关系图鉴-小世界理论</h1>
        
        <p class="lead text-gray mt-3" style="color: black">By 小新; Published on 2020-03-04</p>
        
        <div class="tags">
            <ul class="tag-list">
                
                <li class="tag-list-item">
                    <a class="tag-list-link" href="/tags/爬虫/">爬虫</a>
                </li>
                
                <li class="tag-list-item">
                    <a class="tag-list-link" href="/tags/社会理论/">社会理论</a>
                </li>
                
                <li class="tag-list-item">
                    <a class="tag-list-link" href="/tags/图/">图</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</div>
    <div class="container">
        <div class="row">
            <div class="col-md-9 pt-2">
                <div class="row">
                    <div class="col-12">
                        <main>
                            <article class="article-text page-content"><h1 id="人际关系网络"><a href="#人际关系网络" class="headerlink" title="人际关系网络"></a>人际关系网络</h1><h2 id="小世界理论"><a href="#小世界理论" class="headerlink" title="小世界理论"></a>小世界理论</h2><p>S. Milgram（1967）提出的小世界理论。<br>Milgram的实验内容：</p>
<ul>
<li>设计：选择一个随机起点，观察需要经过多少个中间人，能够到达目标点。</li>
<li>规则：参与者只能将信件转发给能直呼其名的熟人，并请他继续转发；如果一个参与者不认识目标收信人，则他不能直接将信寄给他；参与者需力争让信件能尽早达到目的地</li>
</ul>
<p>实验结果是平均中间人数为5-6人。远远低于预想距离。</p>
<p>实验揭示的核心内容是</p>
<ul>
<li>世界是小的（6度分割）：社会网络中包含丰富的短路径。<br>稍微玄学一点的说法是：在社会网络中，世界上任何两个人之间的平均距离为6。也就是说，任意两个看似风马牛不相干的人，通过6个朋友就可以联系起来。</li>
<li>“自动寻找”短路径：“有目的的转发”能“自动地”找到这些短路径。</li>
</ul>
<p>这就是著名的小世界理论。</p>
<h1 id="名人关系验证"><a href="#名人关系验证" class="headerlink" title="名人关系验证"></a>名人关系验证</h1><p>非常有意思的一个理论。设想一下，任意两个看起来八竿子打不着的人，其实都有冥冥中的某种联系……<br>那何不来亲自验证一下。</p>
<h2 id="数据收集"><a href="#数据收集" class="headerlink" title="数据收集"></a>数据收集</h2><p>大量的人物信息及其人物关系数据。这种数据确实不好找。<br>这里就使用百度百科上的人物关系数据。<br>鲁迅先生说过，“单是说不行，要紧的是做。”<br>这里以鲁迅先生为例：<br><img src="%E7%99%BE%E5%BA%A6%E7%99%BE%E7%A7%91-%E9%B2%81%E8%BF%85.png" alt="百度百科-鲁迅" title="百度百科-鲁迅"><br>百度百科上每个人物都有其人物关系。<br>编写爬虫，从鲁迅先生开始，沿着其人物关系链开始扒取数据。</p>
<p>首先定义一个人物类：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></span><br><span class="line">	<span class="string">'''人物 类'''</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, ID, name=None, url=None)</span>:</span></span><br><span class="line">		self.id = ID</span><br><span class="line">		self.name = name  <span class="comment"># 名字</span></span><br><span class="line">		self.relation = dict()  <span class="comment"># 关系 &#123;relation: [name1, name2 ...]&#125;</span></span><br><span class="line">		self.pic = <span class="literal">None</span>  <span class="comment"># 封面</span></span><br><span class="line">		self.url = url  <span class="comment"># url</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">add_relation</span><span class="params">(self, relation, name)</span>:</span></span><br><span class="line">		<span class="string">'''person.add_relation(relation, name)</span></span><br><span class="line"><span class="string">		relation: (str) 关系</span></span><br><span class="line"><span class="string">		name：（str）名字'''</span></span><br><span class="line">		<span class="keyword">if</span> relation <span class="keyword">not</span> <span class="keyword">in</span> self.relation.keys():</span><br><span class="line">			self.relation[relation] = [name]</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">if</span> name <span class="keyword">not</span> <span class="keyword">in</span> self.relation[relation]:</span><br><span class="line">				self.relation[relation].append(name)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				print(<span class="string">"&#123;&#125;-&#123;&#125;已存在"</span>.format(relation, name))</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">add_pic</span><span class="params">(self, pic)</span>:</span></span><br><span class="line">		self.pic = pic</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">to_string</span><span class="params">(self)</span>:</span></span><br><span class="line">		print(<span class="string">"name:&#123;&#125;"</span>.format(self.name))</span><br><span class="line">		print(<span class="string">"relations:&#123;&#125;"</span>.format(self.relation))</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">save_file</span><span class="params">(self)</span>:</span></span><br><span class="line">		<span class="string">'''将人物信息保存到文件，如果文件不存在则创建，如果已存在则追加'''</span></span><br><span class="line">		<span class="keyword">with</span> open(crawled_person_file, <span class="string">'a'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">			f.write(<span class="string">"&#123;&#125;\n"</span>.format(self.id))</span><br><span class="line">			f.write(<span class="string">"&#123;&#125;\n"</span>.format(self.name))</span><br><span class="line">			f.write(<span class="string">"&#123;&#125;\n"</span>.format(self.pic))</span><br><span class="line">			f.write(<span class="string">"&#123;&#125;\n"</span>.format(self.url))</span><br><span class="line">			<span class="keyword">for</span> relation, name <span class="keyword">in</span> self.relation.items():</span><br><span class="line">				f.write(<span class="string">"&#123;&#125;:&#123;&#125;\n"</span>.format(relation, <span class="string">" "</span>.join(name)))</span><br><span class="line">			f.write(<span class="string">"\n"</span>)</span><br><span class="line">		print(<span class="string">"save &#123;&#125; done."</span>.format(self.name))</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">save_relations</span><span class="params">(self)</span>:</span></span><br><span class="line">		<span class="string">'''将关系保存到文件，如果文件不存在则创建，如果文件已存在则追加'''</span></span><br><span class="line">		relations = []</span><br><span class="line">		<span class="keyword">with</span> open(crawled_relation_file, <span class="string">'a'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">			<span class="keyword">for</span> relation, names <span class="keyword">in</span> self.relation.items():</span><br><span class="line">				<span class="keyword">for</span> name <span class="keyword">in</span> names:</span><br><span class="line">					f.write(Relation(self.name, name, relation).to_string())</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__eq__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">		<span class="keyword">if</span> isinstance(other, Person):</span><br><span class="line">			<span class="keyword">return</span> self.id == other.id</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">return</span> self.id == other</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">		<span class="keyword">return</span> self.name</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">relation_with</span><span class="params">(self, person_name)</span>:</span></span><br><span class="line">		<span class="string">'''给定一个person，判断与自己的关系。如果没有直接关系，返回None'''</span></span><br><span class="line">		<span class="keyword">if</span> self.name == person_name:</span><br><span class="line">			<span class="keyword">return</span> <span class="string">'self'</span></span><br><span class="line">		<span class="keyword">for</span> relation, names <span class="keyword">in</span> self.relation.items():</span><br><span class="line">			<span class="keyword">for</span> name <span class="keyword">in</span> names:</span><br><span class="line">				<span class="keyword">if</span> person_name == name:</span><br><span class="line">					<span class="keyword">return</span> relation</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download_data</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="string">'''从百度百科上扒数据'''</span></span><br><span class="line">	count = <span class="number">100000</span>  <span class="comment"># 定一个上限人数</span></span><br><span class="line">	person_list = []</span><br><span class="line">	relation_list = []</span><br><span class="line">	strat_person = <span class="string">r'https://baike.baidu.com/item/%E9%B2%81%E8%BF%85/36231'</span></span><br><span class="line">	global_url_list.append(strat_person)  <span class="comment"># 保存全局url</span></span><br><span class="line">	<span class="keyword">for</span> i, url <span class="keyword">in</span> enumerate(global_url_list):</span><br><span class="line">		print(<span class="string">"&#123;&#125;: &#123;&#125;"</span>.format(i, url))</span><br><span class="line">		person = get_person(url)</span><br><span class="line">		<span class="keyword">if</span> i &gt; count:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	print(<span class="string">"done!"</span>)</span><br></pre></td></tr></table></figure>

<p><code>global_url_list</code>保存全部要爬取的url。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_person</span><span class="params">(url)</span>:</span></span><br><span class="line">	<span class="string">'''爬取url对应人物的数据</span></span><br><span class="line"><span class="string">	返回person对象'''</span></span><br><span class="line">	html = requests.get(url, headers=header, timeout=<span class="number">10</span>)</span><br><span class="line">	html = html.content</span><br><span class="line">	soup = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">	name = soup.find(<span class="string">'h1'</span>).text.replace(<span class="string">' '</span>, <span class="string">'·'</span>).upper()</span><br><span class="line">	print(name)</span><br><span class="line">	<span class="keyword">if</span> <span class="string">'错误'</span> <span class="keyword">in</span> name:</span><br><span class="line">		print(<span class="string">"&#123;&#125; error! skip!"</span>.format(url))</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	ID = url.split(<span class="string">'/'</span>)[<span class="number">-1</span>]</span><br><span class="line">	cur_person = Person(name, ID, url)</span><br><span class="line">	</span><br><span class="line">	<span class="comment"># 定位relations部分</span></span><br><span class="line">	<span class="comment"># 如果该页面有 slider_relations，直接定位到人物关系</span></span><br><span class="line">	relations = soup.find(id=<span class="string">'slider_relations'</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> relations <span class="keyword">is</span> <span class="literal">None</span>:  <span class="comment"># 如果没有slider_relations项</span></span><br><span class="line">		relations = soup.select(<span class="string">'ul.slider.maqueeCanvas'</span>)</span><br><span class="line">		<span class="keyword">if</span> len(relations) == <span class="number">0</span>:  <span class="comment"># 没有关系，爬虫终止</span></span><br><span class="line">			<span class="keyword">if</span> url <span class="keyword">not</span> <span class="keyword">in</span> global_exists_url_list:</span><br><span class="line">				cur_person.save_file()</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		<span class="keyword">if</span> relations[<span class="number">0</span>].parent[<span class="string">'id'</span>] == <span class="string">'slider_works'</span>:  <span class="comment"># 如果爬到的是作品而不是人物关系</span></span><br><span class="line">			<span class="keyword">if</span> url <span class="keyword">not</span> <span class="keyword">in</span> global_exists_url_list:</span><br><span class="line">				cur_person.save_file()</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		relations = soup.select(<span class="string">'ul.slider.maqueeCanvas'</span>)[<span class="number">0</span>].find_all(<span class="string">'li'</span>)</span><br><span class="line">	<span class="keyword">else</span>:  <span class="comment"># 如果有slider_relations</span></span><br><span class="line">		relations = relations.select(<span class="string">'ul.slider.maqueeCanvas'</span>)[<span class="number">0</span>].find_all(<span class="string">'li'</span>)</span><br><span class="line">		<span class="keyword">if</span> len(relations) == <span class="number">0</span>:  <span class="comment"># 没有关系，爬虫终止</span></span><br><span class="line">			<span class="keyword">if</span> url <span class="keyword">not</span> <span class="keyword">in</span> global_exists_url_list:</span><br><span class="line">				cur_person.save_file()</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">	<span class="comment"># 定位relation部分 END</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 为用户添加关系</span></span><br><span class="line">	<span class="keyword">for</span> person <span class="keyword">in</span> relations:</span><br><span class="line">		pic = person.img[<span class="string">'src'</span>]</span><br><span class="line">		ID = person.a[<span class="string">'href'</span>].split(<span class="string">'/'</span>)[<span class="number">-1</span>]</span><br><span class="line">		next_url = <span class="string">"https://baike.baidu.com"</span> + person.a[<span class="string">'href'</span>]</span><br><span class="line">		<span class="keyword">if</span> next_url <span class="keyword">not</span> <span class="keyword">in</span> global_url_list <span class="keyword">and</span> next_url != <span class="string">"https://baike.baidu.com"</span>:  <span class="comment"># 过滤掉重复人物</span></span><br><span class="line">			global_url_list.append(next_url)</span><br><span class="line">		person = person.div</span><br><span class="line">		<span class="comment"># print(person)</span></span><br><span class="line">		name = person[<span class="string">'title'</span>]</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> person.span <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">			relation = person.text.replace(name, <span class="string">''</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			relation = person.span.text</span><br><span class="line">		cur_person.add_relation(relation, ID)</span><br><span class="line">		cur_person.add_pic(pic)</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 为用户添加关系 END</span></span><br><span class="line">		</span><br><span class="line">	<span class="keyword">if</span> cur_person.url <span class="keyword">in</span> global_exists_url_list:</span><br><span class="line">		print(<span class="string">"&#123;&#125; exists, skip.."</span>.format(person.name))</span><br><span class="line">	<span class="keyword">else</span>:  <span class="comment"># 保存人物信息</span></span><br><span class="line">		cur_person.save_file()</span><br><span class="line">		cur_person.save_relations()</span><br><span class="line">	<span class="keyword">return</span> cur_person</span><br></pre></td></tr></table></figure>

<p>将爬取的全部人物数据保存在文件中。之后要对爬取的数据进行一定的清洗，因为百度百科上数据还是比较杂的，有些人物的信息已经找不到了，以及还有重名的人物等等。一开始没有考虑到人物数量会有那么大，也就没考虑有重名的人的情况。结果爬下来才发现，有重名的人那么多-_-||。。。然后又重新为每个人增加了ID编号。</p>
<p>得到所有人物关系之后，做一个简单的可视化，由于人数太多，暂时不知道用什么方法能够清晰地展示那么大的图网络，这里只可视化了一种一小小小部分。<br><img src="%E5%85%B3%E7%B3%BB1.png" alt="关系1" title="关系1"><br><img src="%E5%85%B3%E7%B3%BB2.png" alt="关系2" title="关系2"><br><img src="%E5%85%B3%E7%B3%BB3.png" alt="关系3" title="关系3"></p>
<h1 id="关系搜索"><a href="#关系搜索" class="headerlink" title="关系搜索"></a>关系搜索</h1><p>有了关系图之后，现在想实现以下功能：<br>输入任意两个人物名字，输出两人之间的关系链。<br>问题就变成了一个图搜索问题。<br>这里实现了一个BFS搜索算法进行关系搜索。<br>具体的完整代码在下面给出。<br>给出一个模型的输出例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">输入：鲁迅， 杨幂</span><br><span class="line">输出：</span><br><span class="line">鲁迅 - 战友 - 冯乃超</span><br><span class="line">冯乃超 - 外甥女 - 李丹阳</span><br><span class="line">李丹阳 - 老师 - 金铁霖</span><br><span class="line">金铁霖 - 妻子 - 马秋华</span><br><span class="line">马秋华 - 学生 - 曹芙嘉</span><br><span class="line">曹芙嘉 - 老师 - 韩红</span><br><span class="line">韩红 - 好友 - 谭维维</span><br><span class="line">谭维维 - 好友 - 杨幂</span><br></pre></td></tr></table></figure>

<p>以鲁迅先生作为开始节点，沿着关系网进行爬取，最后居然爬到了一万多人，可谓古今中外的人都有。果然令人感叹这个世界太小了。甚至是不同时代不同地域的人都在无形中相互联系着。<br>而且百度百科中所列的关系必定不全，只是一个人所有社交关系的及其微小的一小部分，如果人物关系能够更加丰富完整，想必从一个人开始爬遍整个世界还真不是不可能。</p>
<p>项目完整代码<a href="https://github.com/LHYxx/SmallWorld" target="_blank" rel="noopener">在这里~</a></p>
<p>运行说明，前三步只需运行一遍。后面即可进行搜索。</p>
<pre><code>1. download_data()            #爬取数据，需要制定一个start_url，默认为鲁迅先生。爬取的人物数据默认保存在crawled_person_file中。为方便起见，关系数据单独拎出来一份，保存在crawled_relation_file中
2. clean_data(crawled_person_file, cleaned_person_file)  # 清洗人物数据
3. clean_relation_data(cleaned_person_file, crawled_relation_file, cleaned_relation_file)  # 清洗关系数据
4. Search(&apos;鲁迅&apos;, &apos;钱玄同&apos;)</code></pre></article>
                        </main>
                        
                        
                    </div>
                </div>
                <div class="row mt-5 mb-5">
                    <div class="col-12">
                        <div class="row">
    <div class="col">
        <nav aria-label="paginator" class="paginator">
            <ul class="pagination d-none d-md-flex pagination-lg justify-content-center">
                <li class="page-item  disabled ">
                    <a class="page-link"
                        href=""
                        aria-label="Previous">
                        <span aria-hidden="true">&laquo;
                            No more</span>
                        <span class="sr-only">Previous</span>
                    </a>
                </li>
                <li class="page-item ">
                    <a class="page-link"
                        href="/2020/02/15/git使用手册/"
                        aria-label="Next">
                        <span
                            aria-hidden="true">git使用手册
                            &raquo;</span>
                        <span class="sr-only">Next</span>
                    </a>
                </li>
            </ul>
            <ul class="pagination d-md-none justify-content-center">
                <li class="page-item  disabled ">
                    <a class="page-link"
                        href=""
                        aria-label="Previous">
                        <span aria-hidden="true">&laquo;
                            No more</span>
                        <span class="sr-only">Previous</span>
                    </a>
                </li>
                <li class="page-item ">
                    <a class="page-link"
                        href="/2020/02/15/git使用手册/"
                        aria-label="Next">
                        <span
                            aria-hidden="true">git使用手册
                            &raquo;</span>
                        <span class="sr-only">Next</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</div>



                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <div id="vcomment"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="container pt-4 page-sidebar">
                    
                    <div class="row">
    <div class="col">
        <h6>APPLAUSE FOR ME</h6>
        <div id="applause-easy"></div>
    </div>
</div>
                    
                    <hr class="row">
                    <div class="row toc-container">
                        <div class="col-12">
                            <h6>NAVIGATION</h6>
                            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#人际关系网络"><span class="toc-text">人际关系网络</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#小世界理论"><span class="toc-text">小世界理论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#名人关系验证"><span class="toc-text">名人关系验证</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#数据收集"><span class="toc-text">数据收集</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#关系搜索"><span class="toc-text">关系搜索</span></a></li></ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer>
    <div class="jumbotron jumbotron-fluid mb-0">
        <div class="container-fluid">
            <div class="col text-center">
                <div class="bottom-social">
                    <div class="row">
    <div class="col text-center">
        <ul class="list-inline">
            
            <li class="list-inline-item">
                
                <a href="https://github.com/LHYxx">
                    <span class="fa-stack fa-2x icon-link">
                        <i class="fas fa-circle fa-stack-2x"></i>
                        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                    </span>
                </a>
                
            </li>
            
            <li class="list-inline-item">
                
                <a href="https://www.zhihu.com/people/zhihu_name">
                    <span class="fa-stack fa-2x icon-link">
                        <i class="fas fa-circle fa-stack-2x"></i>
                        <i class="fab fa-zhihu fa-stack-1x fa-inverse"></i>
                    </span>
                </a>
                
            </li>
            
        </ul>
    </div>
</div>

                </div>
                <p class="copyright text-muted">
                    Copyright &copy; 小新xx
                    <br>
                    感谢支持！
                    <br>
                    <a href="http://cs.scu.edu.cn/">海纳百川</a>, 
                    <a href="http://www.tju.edu.cn/">实事求是</a>.
                </p>
            </div>
        </div>
    </div>
</footer>

    
    
        <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.slim.min.js"></script>
        <script src="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.bootcss.com/font-awesome/5.9.0/js/all.min.js"></script>
         
            <script type="text/x-mathjax-config">
                MathJax.Hub.Config({
                    CommonHTML: { linebreaks: { automatic: true } },
                    "HTML-CSS": { linebreaks: { automatic: true } },
                    SVG: { linebreaks: { automatic: true } }
                });
            </script>
            <script src='https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
        
    


<script src="/js/av.min.js"></script>
<script src="/js/valine.min.js"></script>
<script src="/js/applause-easy.js"></script>

<script>
$(document).ready(function() {
    var a = new ApplauseEasy({
        id: 'applause-easy',
        appId: "xxxxxxxxxx",
        appKey: "xxxxxxxxxx",
        img_src: "http://img.hanlindong.com/blog/site/clap.png",
        img_width: "50px",
        img_height: "50px"
    })
})
</script>


<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?e8a203f609d8ced2c71c3eee859b6941";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>




    
</body>
</html>